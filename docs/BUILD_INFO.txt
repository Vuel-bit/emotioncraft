Emotioncraft Psyche MVP
Build: v0_2_103_passD (pass41)
Date: 2026-02-17

Highlights (current build)
- Lobby-driven patient loop. Intake is treated as complete for all patients (no Intake gating). Choose WEEKLY / ZEN / TRANQUILITY; TRANSCENDENCE unlocks only after Zen + Tranquility are completed for that patient.
- Patient WIN auto-returns to Lobby to show post-win popups (no SUCCESS banner). LOSE does not auto-return.
- Psyche is per-hue only (0..500 each). Center core is the Treatment hold timer ring + countdown; it flashes red on mental breaks.
- PLAN_CHAIN: psyche comparisons use rounded values (matches HUD numbers) and each plan step can define holdSec (default 10s; 0s for no-hold steps). INTAKE Step 3 is no-hold; WEEKLY is 3 steps (no spin-zero step).
- Timed plans: ZEN / TRANQUILITY / TRANSCENDENCE run on a 10:00 timer (shown as a small pill in the top-right HUD). Timer-expiry loss reason is exactly: "Time expired."
- Mental breaks: first-time-only popups pause and explain break types; break mechanics remain as before (quirks cancelled + ramp timers reset; ~0.5s hit-stop; center flash + affected wells/hues pulse; break details append to the Log overlay).
- Quirks: Fixates (Amount up), Crashes (Amount down), Obsesses (Spin to +100), Spirals (Spin to -100). Telegraph + active phases. Random scheduling uses per-template per-second ramp chances (tier steps 0.00025 / 0.0005 / 0.001) (0.025% / 0.05% / 0.1% per sec), resetting only when that quirk instance ends; capped to at most one newly scheduled quirk per second; global min-gap still applies.
- Debug: default debug panel shows event-based Quirk timeline (mm:ss, type, tier label, well, unshielded force, duration, gap), capped 60. Debug overlay includes a Copy Debug button to copy the current debug text.
- Lobby: Heroes button shows transcended patients (completed TRANSCENDENCE). Lobby details panel shows small badges when Zen and/or Tranquility are completed.
- Lobby: Tutorial button launches a sessionless mechanics walkthrough (no patient slot; no save/progression). Tutorial ends via a completion modal button and disables spillover + mental breaks.
- Lobby: “?” toggle shows detailed explanations for the selected patient’s Mood/Vibe/Traits/Quirks.
- Pass 24: Added EC.ACTIONS facade (core_actions.js). Routed flick/swipe + Spin0/Pair0 through EC.ACTIONS (no behavior changes).
- Pass 25: Implemented EC.ACTIONS as authoritative (no UI delegation). UI controls wrap actions; added controls sync stamp for slider resync.

Run root: open docs/index.html
- Pass 26: Extracted EC.ACTION_MATH (canonical preview/cost/unit rounding/pair cost). Routed ACTIONS + UI controls to it to prevent drift.
- Pass 27: Added app_loop.js (EC.APP.tickMvp). core_mechanics EC.tick delegates MVP branch to app loop (no behavior changes; later inlined).
- Pass 28: Added MVP pipeline module (stepMvp). core_mechanics MECH.step delegates MVP systems ordering to pipeline (no behavior changes).
- Pass 29: Hotfix — Hue Break no longer references undefined msg; MVP tick will not fall through into legacy unless SIM.wells exists.
- Pass 30: Legacy tick removed (MVP-only runtime). Inlined MVP tick into core_mechanics and deleted app_loop.js. Removed dead legacy tick helpers and unused legacy render swirl step.
- Pass 31: Inlined MVP pipeline into core_mechanics and removed the pipeline layer (no behavior changes).
- Pass 32: Removed legacy Imprint/Trauma/Cleanse prototype system (no gameplay changes).

- Pass 33: Removed legacy SIM.wells well-view renderer and deleted dependent core_model display/well helpers. render_wells is now MVP-only (layout + psyche + resize). (No gameplay changes.)
- Pass 34: Removed stray render_wells.js.bak; moved gesture helpers + DOM pointer bridge to systems_input; removed final legacy SIM.wells fallback from input (no behavior changes).
- Pass 35: Main.js hygiene: removed inline input debug ladder; moved input debug recorders + touchstart arming helper into systems_input; standardized inputDbg bucket (no gameplay changes).
- Pass 36: Extracted patient roster to data_roster.js (EC.DATA.ROSTER). systems_patients consumes roster from EC.DATA (no behavior changes).
- Pass 37: Extracted plan specs to data_plans.js (EC.DATA.PLANS); systems_patients consumes EC.DATA.PLANS.
- Pass 38: Extracted tutorial def + step specs/copy to data_tutorial.js (EC.DATA.TUTORIAL); systems_tutorial consumes EC.DATA.TUTORIAL (no behavior changes).
- Pass 39: Hotfix — canonical input release resolver shared by DOM pointer + touch (restores desktop long-press drag scaling); weekly win reliably triggers reward overlay via planKey normalization; gesture coords/debug hidden by default (?inputdebug=1).
- Pass 40: Stage pointer-up fallback now routes through canonical release resolver (removes duplicate flick-only logic). Weekly fallback label preserved. No behavior changes.
- Pass 41: Tranquility thresholds/bands updated (data-only). Spill/break info popups now persist once-per-player via Firestore ui.seenFirstPopups (still session-only when signed out).
